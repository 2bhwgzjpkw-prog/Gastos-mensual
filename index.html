<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gastos Mensuales</title>

<style>
body{
    margin:0;
    font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
    background:#0d0d0f;
    color:#fff;
}
.container{
    max-width:420px;
    margin:auto;
    padding:20px;
}
h1{
    margin-bottom:15px;
}
.month{
    background:#1c1c20;
    border-radius:14px;
    padding:14px 16px;
    margin-bottom:10px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    cursor:pointer;
}
.month span.total{
    color:#b0b0b5;
}
.hidden{display:none;}

.card{
    background:#1c1c20;
    border-radius:14px;
    padding:14px;
    margin-bottom:10px;
    display:flex;
    justify-content:space-between;
    align-items:center;
}
.amount.neg{color:#ff5c5c;}
.amount.pos{color:#4cd964;}
.trash{
    color:#ff5c5c;
    cursor:pointer;
    font-size:18px;
}
input,select{
    width:100%;
    padding:12px;
    border:none;
    border-radius:10px;
    background:#2a2a30;
    color:white;
    margin-bottom:10px;
    font-size:16px;
}
button{
    width:100%;
    padding:14px;
    border:none;
    border-radius:14px;
    background:#0a84ff;
    color:white;
    font-size:18px;
}
.total{
    text-align:right;
    margin-top:10px;
    font-size:20px;
}
.back{
    margin-bottom:10px;
    color:#0a84ff;
    cursor:pointer;
}
</style>
</head>

<body>
<div class="container">

<h1 id="title">Meses</h1>

<div id="months"></div>

<div id="detail" class="hidden">
    <div class="back" onclick="goBack()">‚Üê Volver</div>

    <input id="desc" placeholder="Descripci√≥n">
    <input id="amount" type="number" placeholder="Monto">
    <select id="type">
        <option value="pos">Ingreso</option>
        <option value="neg">Egreso</option>
    </select>
    <button onclick="add()">Agregar</button>

    <div id="list"></div>
    <div class="total" id="total"></div>
</div>

</div>

<script>
const months=[
"Enero","Febrero","Marzo","Abril","Mayo","Junio",
"Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"
];

let data=JSON.parse(localStorage.getItem("gastos"))||{};
let current=null;

function money(n){
    return n.toLocaleString("es-MX",{minimumFractionDigits:0});
}

function save(){
    localStorage.setItem("gastos",JSON.stringify(data));
}

function renderMonths(){
    const m=document.getElementById("months");
    m.innerHTML="";
    months.forEach(mon=>{
        const total=(data[mon]||[]).reduce((s,i)=>s+(i.type=="neg"?-i.amount:i.amount),0);
        const d=document.createElement("div");
        d.className="month";
        d.innerHTML=`<span>${mon}</span><span class="total">$${money(total)}</span>`;
        d.onclick=()=>open(mon);
        m.appendChild(d);
    });
}

function open(mon){
    current=mon;
    document.getElementById("title").innerText=mon;
    document.getElementById("months").classList.add("hidden");
    document.getElementById("detail").classList.remove("hidden");
    renderList();
}

function goBack(){
    current=null;
    document.getElementById("title").innerText="Meses";
    document.getElementById("months").classList.remove("hidden");
    document.getElementById("detail").classList.add("hidden");
    renderMonths();
}

function add(){
    const desc=document.getElementById("desc").value;
    const amt=Number(document.getElementById("amount").value);
    const type=document.getElementById("type").value;
    if(!desc||!amt)return;

    data[current]=data[current]||[];
    data[current].push({desc,amount:amt,type});
    save();
    document.getElementById("desc").value="";
    document.getElementById("amount").value="";
    renderList();
}

function remove(i){
    data[current].splice(i,1);
    save();
    renderList();
}

function renderList(){
    const l=document.getElementById("list");
    l.innerHTML="";
    let total=0;

    (data[current]||[]).forEach((it,i)=>{
        total+=it.type=="neg"?-it.amount:it.amount;
        const c=document.createElement("div");
        c.className="card";
        c.innerHTML=`
            <span>${it.desc}</span>
            <span class="amount ${it.type}">
                ${it.type=="neg"?"-":"+"}$${money(it.amount)}
            </span>
            <span class="trash" onclick="remove(${i})">üóë</span>
        `;
        l.appendChild(c);
    });

    document.getElementById("total").innerText=`Total: $${money(total)}`;
}

renderMonths();
</script>
</body>
</html>
